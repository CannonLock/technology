<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>IPv6 Testing - OSG Technology Area</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "IPv6 Testing";
    var mkdocs_page_input_path = "software/ipv6-testing.md";
    var mkdocs_page_url = "/software/ipv6-testing/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> OSG Technology Area</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
  
    <a class="" href="../..">Home</a>
  
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Software</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../development-process/">Development Process</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../markdown-migration/">Migrating Documents to Markdown</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../koji-workflow/">Koji Workflow</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../new-team-member/">New Team Member</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../repository-management/">Repository Management</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../ce-test-scaling/">CE Scale Testing</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../rpm-development-guide/">RPM Development Guide</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../quilt/">Using Quilt</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../upcoming-to-main/">Upcoming to Main</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../policy/software-support/">Software Support</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../effort-tracking/">Effort Tracking</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../release-planning/">Release Planning</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../globus-mass-update-procedure/">Globus Mass Update Procedure</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../git-software-development/">Git Software Development Process</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../osg-build-tools/">OSG Build Tools</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../resurrecting-epel-packages/">Resurrecting Epel Packages</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../koji-mass-rebuilds/">Koji Mass Rebuilds</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../create-vo-client/">Creating the VO Client Package</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../pki-overview/">PKI Overview</a>
  
        </li>
        <li class=" current">
          
  
    <a class="current" href="./">IPv6 Testing</a>
  
  <ul class="subnav">
      
    <li class="toctree-l3"><a href="#testing-software-with-ipv6">Testing Software with IPv6</a></li>
    

    <li class="toctree-l3"><a href="#about-this-document">About this Document</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#requirements">Requirements</a></li>
        
            <li><a class="toctree-l4" href="#enabling-ipv6">Enabling IPV6</a></li>
        
            <li><a class="toctree-l4" href="#testing-ipv6-connectivity">Testing IPv6 connectivity</a></li>
        
            <li><a class="toctree-l4" href="#disabling-ipv4">Disabling IPv4</a></li>
        
            <li><a class="toctree-l4" href="#disabling-ipv6">Disabling IPv6</a></li>
        
            <li><a class="toctree-l4" href="#testing-in-mixed-mode">Testing in mixed mode</a></li>
        
        </ul>
    

  </ul>
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Release</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../release/cut-sw-release/">How to Cut a Release</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/cut-data-release/">How to Cut a Data Release</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/release-policy/">Release Policy</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/release-schedule/">Release Schedule</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/new-release-series/">New Release Series</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/old-release-removal/">Old Release Series Removal</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/condor-itb-testing/">HTCondor Prerelease Testing</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/empty-pkgs/">Empty Packages</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/acceptance-testing/">Acceptance Testing</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Policy</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../policy/gums-retire/">GUMS Retirement</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../policy/bestman2-retire/">BeStMan2 Retirement</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../policy/voms-admin-retire/">VOMS Admin Retirement</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../policy/release-series/">Release Series Support</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../policy/globus-toolkit/">Globus Toolkit Support</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Infrastructure</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../infrastructure/koji-restore-recipe/">Koji Restore Recipe</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../infrastructure/koji-hub-setup/">Koji-Hub Setup</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../infrastructure/koji-inf-overview/">Koji Infrastructure Overview</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../infrastructure/koji-policy-writing/">Koji Policy Writing</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../infrastructure/madison-itb/">Madison ITB</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Documentation</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../documentation/writing-documentation/">Writing Documentation</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Historical Information</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../infrastructure/koji-initial-install/">Koji Initial Install</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Historical Transitions</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../projects/sha2-support/">SHA-2 Support</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OSG Technology Area</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Software &raquo;</li>
        
      
    
    <li>IPv6 Testing</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/opensciencegrid/technology/edit/master/docs/software/ipv6-testing.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="testing-software-with-ipv6">Testing Software with IPv6<a class="headerlink" href="#testing-software-with-ipv6" title="Permanent link">&para;</a></h1>
<h1 id="about-this-document">About this Document<a class="headerlink" href="#about-this-document" title="Permanent link">&para;</a></h1>
<p>This document provides instructions on setting up a host with an IPv6 address for testing the OSG software stack. The plan is to be able to spin up special Fermicloud VM’s that have corresponding public IPv6 addresses meaning that there will be a limit of ~15 VM’s at one time.</p>
<p>For more information on IPv6, consult <a href="http://en.wikipedia.org/wiki/IPv6">Wikipedia</a>.</p>
<h2 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h2>
<p>1 Be familiar with your institute's network policy and firewall configuration 1 <em>Root</em> access is required to configure <code>iptables</code></p>
<h2 id="enabling-ipv6">Enabling IPV6<a class="headerlink" href="#enabling-ipv6" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Determine the public IPv6 address of your host (highlighted in <span style="color:red">red<span class="twiki-macro ENDCOLOR">): </p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> nslookup -type<span class="o">=</span>aaaa &lt;hostname&gt;
<span class="go">Server:     132.239.0.252      </span>
<span class="go">Address:    132.239.0.252#53</span>

<span class="go">Non-authoritative answer:</span>
<span class="go">ipv6vm001.fnal.gov  has AAAA address <span style="color:red">2001:400:2410:29::182</span></span>
</pre></div>


<p>Replacing <code>&lt;hostname&gt;</code> with your machine's hostname.</p>
</li>
<li>
<p>Ask your network administrator for your IPv6 default gateway</p>
</li>
<li>
<p>Modify <code>/etc/sysconfig/network-scripts/ifcfg-eth0</code> and be sure these lines exist, and : </p>
<div class="codehilite"><pre><span></span>IPV6INIT=yes
IPV6_AUTOCONF=no
IPV6ADDR=&quot;<span style="color:red">IPv6 address</span>&quot;
IPV6_DEFAULTGW=&quot;The IPV6 Default Gateway&quot;
</pre></div>


<p>Replacing <span style="color:red">IPv6 address</span> with the address found in step 1.</p>
</li>
<li>
<p>Restart the network devices:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> service network restart
<span class="go">Shutting down interface eth0:                              [  OK  ]</span>
<span class="go">Shutting down loopback interface:                          [  OK  ]</span>
<span class="go">Bringing up loopback interface:                            [  OK  ]</span>
<span class="go">Bringing up interface eth0:                                [  OK  ]</span>
</pre></div>


</li>
</ol>
<h2 id="testing-ipv6-connectivity">Testing IPv6 connectivity<a class="headerlink" href="#testing-ipv6-connectivity" title="Permanent link">&para;</a></h2>
<p>To verify that the VM is capable of IPv6 we will be using the <code>ping6</code> command between the test VM and another IPv6 capable machine</p>
<ol>
<li>
<p>From another IPv6 capable machine, ping your VM:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> ping6 ipv6vm001.fnal.gov
<span class="go">PING ipv6vm001.fnal.gov(ipv6vm001.fnal.gov) 56 data bytes</span>
<span class="go">64 bytes from ipv6vm001.fnal.gov: icmp_seq=1 ttl=51 time=68.1 ms</span>
<span class="go">64 bytes from ipv6vm001.fnal.gov: icmp_seq=2 ttl=51 time=57.6 ms</span>
</pre></div>


</li>
<li>
<p>From your test VM, ping another IPv6 capable machine (a list of IPv6 machines can be found <a href="#Ipv6Vms">here</a>):</p>
<div class="codehilite"><pre><span></span><span class="gp">[efajardo@ipv6vm001 ~]#</span> ping6 uaf-4.t2.ucsd.edu
<span class="go">PING uaf-4.t2.ucsd.edu(uaf-4.t2.ucsd.edu) 56 data bytes</span>
<span class="go">64 bytes from uaf-4.t2.ucsd.edu: icmp_seq=1 ttl=51 time=57.6 ms</span>
</pre></div>


</li>
</ol>
<h3 id="verifying-ssh-over-ipv6">Verifying SSH over IPv6<a class="headerlink" href="#verifying-ssh-over-ipv6" title="Permanent link">&para;</a></h3>
<p>Make sure you can login to your VM over IPv6. Currently, Fermilab's kerberos does not support SSH over IPv6.</p>
<ol>
<li>
<p>Add your ssh_key to your machine and make sure <code>/etc/ssh/sshd_config</code> has the following lines: </p>
<div class="codehilite"><pre><span></span>RSAAuthentication yes
PubkeyAuthentication yes
</pre></div>


</li>
<li>
<p>Try connecting to you IPv6 enabled machine over SSH: </p>
<div class="codehilite"><pre><span></span><span class="gp">efajardo@uaf-4 ~$</span> ssh -6 root@ipv6vm001.fnal.gov
<span class="go">Last login: Wed Jun 11 14:51:47 2014 from 2607:f720:1700:1b30:21f:c6ff:feeb:2631</span>
<span class="gp">[root@ipv6vm001 ~]#</span>
</pre></div>


</li>
</ol>
<h2 id="disabling-ipv4">Disabling IPv4<a class="headerlink" href="#disabling-ipv4" title="Permanent link">&para;</a></h2>
<p>If you were able to log into your VM over IPv6, you can disable IPv4 and try to communicate exclusively over IPv6.</p>
<ol>
<li>
<p>Comment the <code>IPADDR</code> line in <code>/etc/sysconfig/network-scripts/ifcfg-eth0</code>:</p>
<div class="codehilite"><pre><span></span>#IPADDR=131.225.41.182
IPV6ADDR=&quot;2607:f720:1700:1b30::9b&quot;
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure that your <code>IPV6ADDR</code> is uncommented otherwise you will not be able to connect to the host again</p>
</div>
</li>
<li>
<p>Restart the network services: </p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> service network restart
</pre></div>


</li>
<li>
<p>The ping command should no longer work: </p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> ping ipv6vm001.fnal.gov
<span class="go">PING ipv6vm001.fnal.gov (131.225.41.182): 56 data bytes</span>
<span class="go">Request timeout for icmp_seq 0</span>
<span class="go">Request timeout for icmp_seq 1</span>
</pre></div>


</li>
</ol>
<h2 id="disabling-ipv6">Disabling IPv6<a class="headerlink" href="#disabling-ipv6" title="Permanent link">&para;</a></h2>
<p>In your testing, you may find the need to disable IPv6.</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> sysctl -w net.ipv6.conf.all.disable_ipv6<span class="o">=</span><span class="m">1</span>
<span class="gp">root@host #</span> service network restart
</pre></div>


<p>The <code>ping6</code> command should no longer work: </p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> ping6 ipv6vm001.fnal.gov
<span class="go">Request timeout for icmp_seq 0</span>
<span class="go">Request timeout for icmp_seq 1</span>
</pre></div>


<h2 id="testing-in-mixed-mode">Testing in mixed mode<a class="headerlink" href="#testing-in-mixed-mode" title="Permanent link">&para;</a></h2>
<p>To test IPv6 in mixed mode, you can use the <code>ntop</code> tool to monitor traffic over IPv6. <code>ntop</code> is installed on all the test machines and you can access the web interface at <em>hostname:3000</em>. To see a table that displays network traffic between your VM and another host by going to <em>All Protocols</em> -&gt; <em>Traffic</em> and looking at the IPv6 column.</p>
<p><img alt="NTP-web" src="../../images/ipv6-testing.png" /></p>
<h3 id="enforcing-communication-over-ipv6">Enforcing communication over IPv6<a class="headerlink" href="#enforcing-communication-over-ipv6" title="Permanent link">&para;</a></h3>
<p>If you want to enforce IPv6 over mixed mode you can try using the IPv6 address for whatever software that you are testing. For example with xrdcp:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> xrdcp -d <span class="m">1</span> /tmp/first_test root://<span class="o">[</span><span class="m">2607</span>:f720:1700:1b30::a4<span class="o">]</span>:1094//tmp/first_test_8
<span class="go">[19B/19B][100%][==================================================][0B/s] </span>
</pre></div>


<p>Notice that the IPv6 address follows <a href="http://www.ietf.org/rfc/rfc2732.txt">RFC2732</a>.</p>
<table>
<thead>
<tr>
<th align="right">Node</th>
<th align="right">Owner</th>
<th align="left">Last Verified</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">cabinet-10-10-1.t2.ucsd.edu</td>
<td align="right">Edgar</td>
<td align="left">23-Jan-2014</td>
</tr>
<tr>
<td align="right">cabinet-10-10-4.t2.ucsd.edu</td>
<td align="right">Edgar</td>
<td align="left">23-Jan-2014</td>
</tr>
<tr>
<td align="right">ipv6vm002.fnal.gov</td>
<td align="right">Edgar</td>
<td align="left">23-Jan-2014</td>
</tr>
<tr>
<td align="right">ipv6vm004.fnal.gov</td>
<td align="right">Edgar</td>
<td align="left">23-Jan-2014</td>
</tr>
</tbody>
</table>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../release/cut-sw-release/" class="btn btn-neutral float-right" title="How to Cut a Release">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../pki-overview/" class="btn btn-neutral" title="PKI Overview"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/opensciencegrid/technology" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../pki-overview/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../release/cut-sw-release/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
