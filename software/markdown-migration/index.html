<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Migrating Documents to Markdown - OSG Technology Area</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Migrating Documents to Markdown";
    var mkdocs_page_input_path = "software/markdown-migration.md";
    var mkdocs_page_url = "/software/markdown-migration/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> OSG Technology Area</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
  
    <a class="" href="../..">Home</a>
  
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Software</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../development-process/">Development Process</a>
  
        </li>
        <li class=" current">
          
  
    <a class="current" href="./">Migrating Documents to Markdown</a>
  
  <ul class="subnav">
      
    <li class="toctree-l3"><a href="#migrating-to-markdown">Migrating to Markdown</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#choosing-the-git-repository">Choosing the git repository</a></li>
        
            <li><a class="toctree-l4" href="#automatic-twiki-conversion">Automatic TWiki conversion</a></li>
        
            <li><a class="toctree-l4" href="#completing-the-conversion">Completing the conversion</a></li>
        
            <li><a class="toctree-l4" href="#archiving-documents">Archiving Documents</a></li>
        
            <li><a class="toctree-l4" href="#submitting-the-pull-request">Submitting the pull request</a></li>
        
            <li><a class="toctree-l4" href="#after-the-pull-request">After the pull request</a></li>
        
            <li><a class="toctree-l4" href="#reviewing-pull-requests">Reviewing pull requests</a></li>
        
        </ul>
    

  </ul>
        </li>
        <li class="">
          
  
    <a class="" href="../koji-workflow/">Koji Workflow</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../new-team-member/">New Team Member</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../repository-management/">Repository Management</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../ce-test-scaling/">CE Scale Testing</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../rpm-development-guide/">RPM Development Guide</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../quilt/">Using Quilt</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../upcoming-to-main/">Upcoming to Main</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../policy/software-support/">Software Support</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../effort-tracking/">Effort Tracking</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../release-planning/">Release Planning</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../globus-mass-update-procedure/">Globus Mass Update Procedure</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../git-software-development/">Git Software Development Process</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../osg-build-tools/">OSG Build Tools</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../resurrecting-epel-packages/">Resurrecting Epel Packages</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../koji-mass-rebuilds/">Koji Mass Rebuilds</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../create-vo-client/">Creating the VO Client Package</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../pki-overview/">PKI Overview</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../ipv6-testing/">IPv6 Testing</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Release</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../release/cut-sw-release/">How to Cut a Release</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/cut-data-release/">How to Cut a Data Release</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/release-policy/">Release Policy</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/release-schedule/">Release Schedule</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/new-release-series/">New Release Series</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/old-release-removal/">Old Release Series Removal</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/condor-itb-testing/">HTCondor Prerelease Testing</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/empty-pkgs/">Empty Packages</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/acceptance-testing/">Acceptance Testing</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Policy</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../policy/gums-retire/">GUMS Retirement</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../policy/bestman2-retire/">BeStMan2 Retirement</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../policy/voms-admin-retire/">VOMS Admin Retirement</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../policy/release-series/">Release Series Support</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../policy/globus-toolkit/">Globus Toolkit Support</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../policy/external-oasis-repos/">OASIS Repository Mirroring</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../policy/flexible-release-model/">Flexible Release Model</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Infrastructure</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../infrastructure/koji-restore-recipe/">Koji Restore Recipe</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../infrastructure/koji-hub-setup/">Koji-Hub Setup</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../infrastructure/koji-inf-overview/">Koji Infrastructure Overview</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../infrastructure/koji-policy-writing/">Koji Policy Writing</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../infrastructure/madison-itb/">Madison ITB</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Documentation</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../documentation/writing-documentation/">Writing Documentation</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Historical Information</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../infrastructure/koji-initial-install/">Koji Initial Install</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Historical Transitions</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../projects/sha2-support/">SHA-2 Support</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OSG Technology Area</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Software &raquo;</li>
        
      
    
    <li>Migrating Documents to Markdown</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/edit/master/docs/software/markdown-migration.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="migrating-to-markdown">Migrating to Markdown<a class="headerlink" href="#migrating-to-markdown" title="Permanent link">&para;</a></h1>
<p>As part of the TWiki retirement (the read-only target date of Oct 1, 2017, with a shutdown date in 2018), we will need to convert the OSG Software and Release3 docs from TWiki syntax to <a href="https://guides.github.com/features/mastering-markdown/">Markdown</a>. The following document outlines the conversion process and conventions.</p>
<h2 id="choosing-the-git-repository">Choosing the git repository<a class="headerlink" href="#choosing-the-git-repository" title="Permanent link">&para;</a></h2>
<p>First you will need to choose which git repoository you will be working with:</p>
<table>
<thead>
<tr>
<th align="left">If you are converting a document from...</th>
<th align="left">Use this github repository...</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">SoftwareTeam</td>
<td align="left"><a href="https://www.github.com/opensciencegrid/technology/">technology</a></td>
</tr>
<tr>
<td align="left">Release3</td>
<td align="left"><a href="https://www.github.com/opensciencegrid/docs/">docs</a></td>
</tr>
</tbody>
</table>
<p>Once you've chosen the target repository for your document, move onto the next section and pick your conversion method.</p>
<h2 id="automatic-twiki-conversion">Automatic TWiki conversion<a class="headerlink" href="#automatic-twiki-conversion" title="Permanent link">&para;</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are only archiving the documents, skip to this <a href="#archiving-documents">section</a>.</p>
</div>
<p>Choose one of the following methods for converting TWiki documents:</p>
<ul>
<li>Using our own <a href="#using-docker">docker conversion image</a> (recommended)</li>
<li>Directly using pandoc and mkdocs <a href="#conversion-without-docker">on your own machine</a></li>
</ul>
<h3 id="using-docker">Using docker<a class="headerlink" href="#using-docker" title="Permanent link">&para;</a></h3>
<p>The twiki-converter docker image can be used to preview the document tree via a <a href="http://www.mkdocs.org/#getting-started">mkdocs</a> development server, archive TWiki documents, and convert documents to Markdown via <a href="http://pandoc.org/">pandoc</a>. The image is available on <code>osghost</code>, otherwise, follow the instructions <a href="https://github.com/brianhlin/docker-twiki-converter">here</a> to build it locally. </p>
<h4 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h4>
<p>To perform a document migration using docker, you will need the following tools and accounts:</p>
<ul>
<li><a href="https://help.github.com/articles/fork-a-repo/">Fork</a> and <a href="https://help.github.com/articles/cloning-a-repository/">clone</a> the repository that you chose in the <a href="#choosing-the-git-repository">above section</a></li>
<li>A host with a running docker service</li>
<li><code>sudo</code> or membership in the <code>docker</code> group</li>
</ul>
<p>If you cannot install the above tools locally, they are available on <code>osghost</code>. Speak with Brian L for access.</p>
<h4 id="preparing-the-git-repository">Preparing the git repository<a class="headerlink" href="#preparing-the-git-repository" title="Permanent link">&para;</a></h4>
<ol>
<li><code>cd</code> into your local git repository</li>
<li>
<p>Add <code>opensciencegrid/technology</code> as the upstream remote repository for merging upstream changes:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> git remote add upstream https://www.github.com/opensciencegrid/<span style="color:red">&lt;REPOSITORY&gt;</span>.git
</pre></div>


</li>
<li>
<p>Create a branch for the document you plan to convert:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> git branch <span style="color:red">&lt;BRANCH NAME&gt;</span> master
</pre></div>


</li>
<li>
<p>Change to the branch you just created</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> git checkout <span style="color:red">&lt;BRANCH NAME&gt;</span>
</pre></div>


</li>
</ol>
<h4 id="previewing-the-document-tree">Previewing the document tree<a class="headerlink" href="#previewing-the-document-tree" title="Permanent link">&para;</a></h4>
<p>When starting a twiki-converter docker container, it expects your local github repository to be mounted in <code>/source</code> so that any changes made to the repository are reflected in the mkdocs development server. To start a docker container based off of the twiki-converter docker image:</p>
<ol>
<li>
<p>Create a container from the image with the following command:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> docker run -d -v <span style="color:red">&lt;PATH TO LOCAL GITHUB REPO&gt;</span>:/source -p <span class="m">8000</span> twiki
</pre></div>


<p>The above command should return the container ID, which will be used in subsequent commands. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the docker container exits immediately, remove the <code>-d</code> option for details. If you see permission denied errors, you may need to disable SELinux or put it in permissive mode.</p>
</div>
</li>
<li>
<p>To find the port that your development server is lisetning on, use the container ID (you should only need the first few chars of the ID) returned from the previous command:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> docker port <span style="color:red">&lt;CONTAINER ID&gt;</span>
</pre></div>


</li>
<li>
<p>Access the development server in your browser via <code>http://osghost.chtc.wisc.edu:&lt;PORT&gt;</code> or <code>localhost:&lt;PORT&gt;</code> for containers run on <code>osghost</code> or locally, respectively. <code>osghost</code> has a restrictive firewall so if you have issues accessing your container from outside of the UW-Madison campus, use an SSH tunnel to map the <code>osghost</code> port to a local port.</p>
</li>
</ol>
<h4 id="converting-documents">Converting documents<a class="headerlink" href="#converting-documents" title="Permanent link">&para;</a></h4>
<p>The docker image contains a convenience script, <code>convert-twiki</code> for saving archives and converting them to Markdown. To run the script in a running container, run the following command:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> docker <span class="nb">exec</span> <span style="color:red">&lt;CONTAINER ID&gt;</span> convert-twiki <span style="color:red">&lt;TWIKI URL&gt;</span>
</pre></div>


<p>Where <span style="color:red"><CONTAINER ID></span> is the docker container ID and <span style="color:red"><TWIKI URL></span> is the link to the TWiki document that you want to convert, e.g. <a href="https://twiki.opensciencegrid.org/bin/view/SoftwareTeam/SoftwareDevelopmentProcess">https://twiki.opensciencegrid.org/bin/view/SoftwareTeam/SoftwareDevelopmentProcess</a>. This will result in an archive of the twiki doc, <code>archive/SoftwareDevelopmentProcess</code>, in your local repo and a converted copy, <code>SoftwareDevelopmentProcess.md</code>, placed into the root of your local github repository.  If the twiki url is for a specific revision of the document, a <code>.rNN</code> will be included in the output filenames.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the above command does not complete quickly, it means that Pandoc is having an issue with a specific section of the document. See <a href="#troubleshooting-conversion">Troubleshooting conversion</a> for next steps.</p>
</div>
<p>To see the converted document in your browser:</p>
<ol>
<li>Rename, move the converted document into a folder in <code>docs/</code>.<ul>
<li>Document file names should be lowercase, <code>-</code> delimited, and descriptive but concise, e.g. <code>markdown-migration.md</code> or <code>cutting-release.md</code></li>
<li>It's not important to get the name/location correct on the first try as this can be discussed in the pull request</li>
</ul>
</li>
<li><code>sudo chown</code> the archived and converted documents to be owned by you</li>
<li>Add the document to the <code>pages:</code> section of <code>mkdocs.yml</code> in <a href="http://titlecase.com/">title case</a>, e.g. <code>- Migrating Documents to Markdown: 'software/markdown-migration.md'</code></li>
<li>Refresh the document tree in your browser</li>
</ol>
<p>Once you can view the converted document in your browser, move onto the <a href="#completing-the-conversion">next section</a></p>
<h4 id="troubleshooting-conversion">Troubleshooting conversion<a class="headerlink" href="#troubleshooting-conversion" title="Permanent link">&para;</a></h4>
<p>Pandoc sometimes has issues converting documents and requires manual intervention by removing whichever section is causing issues in the conversion.</p>
<ol>
<li>Copy the archive of the document into the root of your git repository</li>
<li>
<p>Kill the process in the docker container:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> docker <span class="nb">exec</span> <span style="color:red">&lt;CONTAINER ID&gt;</span> pkill -9 pandoc
</pre></div>


</li>
<li>
<p>Remove a section from the copy of the archive to find the problematic section (recommendation: use a binary search strategy)</p>
</li>
<li>
<p>Run pandoc manually:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> docker <span class="nb">exec</span> <span style="color:red">&lt;CONTAINER ID&gt;</span> pandoc -f twiki -t markdown_github <span style="color:red">&lt;ARCHIVE COPY&gt;</span> &gt; <span style="color:red">&lt;MARKDOWN FILE&gt;</span>
</pre></div>


</li>
<li>
<p>Repeat steps 2-4 until you've narrowed down the problematic section</p>
</li>
<li>Manually convert the offending section</li>
</ol>
<h3 id="conversion-without-docker">Conversion without Docker<a class="headerlink" href="#conversion-without-docker" title="Permanent link">&para;</a></h3>
<p>If you've already used the <a href="#using-docker">docker method</a>, skip to the section about <a href="#completing-the-conversion">completing the conversion</a>. </p>
<h4 id="requirements_1">Requirements<a class="headerlink" href="#requirements_1" title="Permanent link">&para;</a></h4>
<p>This method requires the following:</p>
<ul>
<li><a href="https://help.github.com/articles/fork-a-repo/">Fork</a> and <a href="https://help.github.com/articles/cloning-a-repository/">clone</a> the repository that you chose in the <a href="#choosing-the-git-repository">above section</a></li>
<li>pandoc (&gt; 1.16)</li>
<li>mkdocs</li>
<li>MarkdownHighlight</li>
<li>pygments</li>
</ul>
<h4 id="preparing-the-git-repository_1">Preparing the git repository<a class="headerlink" href="#preparing-the-git-repository_1" title="Permanent link">&para;</a></h4>
<ol>
<li><code>cd</code> into your local git repository</li>
<li>
<p>Add <code>opensciencegrid/technology</code> as the upstream remote repository for merging upstream changes:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> git remote add upstream https://www.github.com/opensciencegrid/<span style="color:red">&lt;REPOSITORY&gt;</span>.git
</pre></div>


</li>
<li>
<p>Create a branch for the document you plan to convert:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> git branch <span style="color:red">&lt;BRANCH NAME&gt;</span> master
</pre></div>


</li>
<li>
<p>Change to the branch you just created</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> git checkout <span style="color:red">&lt;BRANCH NAME&gt;</span>
</pre></div>


</li>
</ol>
<h4 id="archiving-the-twiki-document">Archiving the TWiki document<a class="headerlink" href="#archiving-the-twiki-document" title="Permanent link">&para;</a></h4>
<p>Follow the instructions for <a href="#archiving-documents">archival</a> then continue to the next section to convert the document with pandoc.</p>
<h4 id="initial-conversion-with-pandoc">Initial conversion with Pandoc<a class="headerlink" href="#initial-conversion-with-pandoc" title="Permanent link">&para;</a></h4>
<p><a href="http://pandoc.org/">Pandoc</a> is a tool that's useful for automated conversion of markdown languages. <a href="http://pandoc.org/installing.html">Once installed</a> (alternatively, run pandoc <a href="#using-docker">via docker</a>), run the following command to convert TWiki to Markdown:</p>
<div class="codehilite"><pre><span></span><span class="gp">$</span> pandoc -f twiki -t markdown_github <span style="color:red">&lt;TWIKI FILE&gt;</span> &gt; <span style="color:red">&lt;MARKDOWN FILE&gt;</span>
</pre></div>


<p>Where <code>&lt;TWIKI FILE&gt;</code> is the path to initial document in raw TWiki and <code>&lt;MARKDOWN FILE&gt;</code> is the path to the resulting document in GitHub Markdown.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don't see output from the above command quickly, it means that Pandoc is having an issue with a specific section of the document. Stop the command (or docker container), find and temporarily remove the offending section, convert the remainder of the document with Pandoc, and manually convert the offending section.</p>
</div>
<h4 id="previewing-your-documents-with-mkdocs">Previewing your document(s) with Mkdocs<a class="headerlink" href="#previewing-your-documents-with-mkdocs" title="Permanent link">&para;</a></h4>
<p><a href="http://www.mkdocs.org/">Mkdocs</a> has a development mode that can be used to preview documents as you work on them and is available via package manager or <code>pip</code>. <a href="http://www.mkdocs.org/#installation">Once installed</a>, add your document(s) to the <code>pages</code> section of <code>mkdocs.yml</code> and launch the mkdocs server with the following command from the dir containing <code>mkdocs.yml</code>:</p>
<div class="codehilite"><pre><span></span><span class="gp">$</span> <span class="nv">PYTHONPATH</span><span class="o">=</span>src/ mkdocs serve
</pre></div>


<p>Access the server at <code>http://127.0.0.1:8000</code> and navigate to the document you're working on. It's useful to open the original TWiki doc in an adjacent tab or window to quickly compare the two.</p>
<h2 id="completing-the-conversion">Completing the conversion<a class="headerlink" href="#completing-the-conversion" title="Permanent link">&para;</a></h2>
<p>Manual review of the automatically converted documents are required since the automatic conversion process isn't perfect. This section contains a list of problems commonly encountered in automatically converted documents.</p>
<h3 id="headers">Headers<a class="headerlink" href="#headers" title="Permanent link">&para;</a></h3>
<p>Use the following conventions for headers</p>
<ol>
<li>There should only be one level 1 heading per document: the title</li>
<li>Level 1 headings should use the <code>====</code> format</li>
<li>Level 2 sub-headings should use the <code>----</code> format</li>
<li>If there is no other introduction to the document, remove the "About this..." sub-heading</li>
</ol>
<h3 id="broken-links">Broken links<a class="headerlink" href="#broken-links" title="Permanent link">&para;</a></h3>
<p>Pandoc isn't aware of the entire TWiki structure so internal links using <a href="http://twiki.org/cgi-bin/view/TWiki/WikiWord">WikiWords</a> result in broken links. If the broken link is for a document that has already been migrated to GitHub, link to it using relative paths to the markdown doc of interest. If the broken link is for a document that hasn't been migrated to GitHub, consult the documentation spreadsheet (contact Brian L for access) to see if it's targeted for archival.</p>
<p>If the broken link is:</p>
<ol>
<li>For a document that has already been migrated to GitHub, update it to point at the new location.</li>
<li>For a document that not been migrated to GitHub, consult the documentation spreadsheet (contact Brian L for access):<ul>
<li>If the link is targeted for archival, remove the link if it makes sense. If you're unsure, be sure to mention it in your final pull request</li>
<li>If the link is not targeted for archival, link directly to the TWiki page.</li>
</ul>
</li>
</ol>
<h4 id="fixing-sub-section-links">Fixing sub-section links<a class="headerlink" href="#fixing-sub-section-links" title="Permanent link">&para;</a></h4>
<p>To link sections within a page, lowercase the entire section name and replace spaces with dashes. If there are multiple sections with the same name you can link the subsequent sections by appending <code>_N</code> where <code>N</code> is the section's ordinal number minus one, e.g. append <code>_1</code> for the second section. For example, if you have three sections named "Optional Configuration", link them like so:</p>
<div class="codehilite"><pre><span></span>[1st section](#optional-configuration)
[2nd section](#optional-configuration_1)
[3rd section](#optional-configuration_2)
</pre></div>


<h3 id="broken-command-blocks-and-file-snippets">Broken command blocks and file snippets<a class="headerlink" href="#broken-command-blocks-and-file-snippets" title="Permanent link">&para;</a></h3>
<p>Pandoc doesn't do a good job of converting our <code>&lt;pre class=...</code> blocks so manual intervention is required. Command blocks and file snippets should be wrapped in three backticks (```) followed by an optional code highlighting format:</p>
<div class="codehilite"><pre><span></span>```python
# stuff
```
</pre></div>


<p>Make sure to use the TWiki document as a reference when making fixes!</p>
<p>We use the <a href="http://pygments.org/">Pygments</a> highlighting library for syntax; it knows about 100 different languages.  The Pygments website contains a live renderer if you want to see how your text will come out.  Please use the <code>console</code> language for shell sessions.</p>
<h4 id="fixing-root-and-user-prompts">Fixing root and user prompts<a class="headerlink" href="#fixing-root-and-user-prompts" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th align="left">Find and replace...</th>
<th align="left">With...</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>&lt;span class="twiki-macro UCL\_PROMPT\_ROOT"&gt;&lt;/span&gt;</code></td>
<td align="left"><code>root@host #</code></td>
</tr>
<tr>
<td align="left"><code>&lt;span class="twiki-macro UCL\_PROMPT"&gt;&lt;/span&gt;</code></td>
<td align="left"><code>user@host $</code></td>
</tr>
</tbody>
</table>
<h4 id="highlighting-user-input">Highlighting user input<a class="headerlink" href="#highlighting-user-input" title="Permanent link">&para;</a></h4>
<p>Within command blocks and file snippets, we've used <code>&amp;lt;...&amp;gt;</code> to highlight areas that users would have to insert text specific to their site. For now, use desciptive, all-caps text wrapped in angle brackets to indicate user input. You may also use TWiki-style color highlighting. </p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> condor_ce_trace -d <span style="color:red">&lt;CE HOSTNAME&gt;</span>
</pre></div>


<h4 id="ordered-lists">Ordered Lists<a class="headerlink" href="#ordered-lists" title="Permanent link">&para;</a></h4>
<p>Ordered lists are often broken up into multiple lists if there are command blocks/file snippets and/or additional text within one of the list items. To make sure the contents of an item are indented properly, use the following formatting:</p>
<ul>
<li>For code blocks or file snippets, add an empty line after any regular text, then insert <code>(N+1)*4</code> spaces at the beginning of each line, where N is the level of the item in the list. To apply code highlighting, start the code block with <code>:::&lt;FORMAT&gt;</code>; see <a href="http://squidfunk.github.io/mkdocs-material/extensions/codehilite/">this page</a> for details, including possible highlighting formats.  For an example of formatting a code section inside a list, see <a href="https://github.com/opensciencegrid/docs/blob/master/docs/release/release_series.md">the release series document</a>.</li>
<li>For additional text (i.e. after a code block), insert <code>N*4</code> spaces at the beginning of each line, where N is the level of the item in the list.</li>
</ul>
<p>For example:</p>
<div class="codehilite"><pre><span></span>1. Foo
    - Bar

            :::console
            COMMAND
            BLOCK
        text associated with Bar

    text associated with Foo

2. Baz

        FILE
        SNIPPET
</pre></div>


<p>There are 12 spaces and 8 spaces in front of the command block and text associated with <code>Bar</code>, respectively; 4 spaces in front of the text associated with <code>Foo</code>; and 8 spaces in front of the file snippet associated with <code>Baz</code>.  The above block is rendered below:</p>
<ol>
<li>
<p>Foo</p>
<ul>
<li>Bar<div class="codehilite"><pre><span></span><span class="go">COMMAND</span>
<span class="go">BLOCK</span>
</pre></div>


<p>text associated with Bar</p>
</li>
</ul>
<p>text associated with Foo</p>
</li>
<li>
<p>Baz</p>
<div class="codehilite"><pre><span></span>FILE
SNIPPET
</pre></div>


</li>
</ol>
<h3 id="notes">Notes<a class="headerlink" href="#notes" title="Permanent link">&para;</a></h3>
<p>To catch the user's attention for important items or pitfalls, we used <code>%NOTE%</code> TWiki macros, these can be replaced with admonition-style notes and warnings:</p>
<div class="codehilite"><pre><span></span>!!! note
    things to note
</pre></div>


<p>or</p>
<div class="codehilite"><pre><span></span>!!! warning
    if a user doesn&#39;t do this thing, bad stuff will happen
</pre></div>


<p>The above blocks are rendered below as an example.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>things to note</p>
</div>
<p>and</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>if a user doesn't do this thing, bad stuff will happen</p>
</div>
<h3 id="obvious-errors">Obvious errors<a class="headerlink" href="#obvious-errors" title="Permanent link">&para;</a></h3>
<p>If you see any other obvious errors (e.g., links to gratia web), feel free to correct them while you're editing the doc <em>iff</em> the changes take less than ~15 minutes. This isn't a renovation project!</p>
<h2 id="archiving-documents">Archiving Documents<a class="headerlink" href="#archiving-documents" title="Permanent link">&para;</a></h2>
<p>If the document is slated for archival (check if it says "yes" in the  "archived" column of the spreadsheet), just download the document to the <code>archive</code> folder of your local git repository:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> <span class="nb">cd</span> technology/
<span class="gp">user@host $</span> curl <span class="s1">&#39;<span style="color:red">&lt;TWIKI URL&gt;</span>?raw=text&#39;</span> <span class="p">|</span> iconv -f windows-1252 &gt; archive/<span style="color:red">&lt;TWIKI TITLE&gt;</span>
</pre></div>


<p>For example:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> <span class="nb">cd</span> technology
<span class="gp">user@host $</span> curl <span class="s1">&#39;https://twiki.opensciencegrid.org/bin/view/Documentation/Release3/SHA2Compliance?raw=text&#39;</span> <span class="p">|</span> iconv -f windows-1252 &gt; archive/SHA2Compliance
</pre></div>


<p>After downloading the document, continue onto the next section to walk through pull request submission.</p>
<h2 id="submitting-the-pull-request">Submitting the pull request<a class="headerlink" href="#submitting-the-pull-request" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Stage the archived raw TWiki (as well as the converted Markdown document(s) and <code>mkdocs.yml</code> if you are converting the document):</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> git add mkdocs.yml archive/<span style="color:red">&lt;TWIKI ARCHIVE&gt;</span> <span style="color:red">&lt;PATH TO CONVERTED DOC&gt;</span>
</pre></div>


</li>
<li>
<p>Commit and push your changes to your GitHub repo:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> git commit -m <span class="s2">&quot;<span style="color:red">&lt;COMMIT MSG&gt;</span>&quot;</span>
<span class="gp">user@host $</span> git push origin <span style="color:red">&lt;BRANCH NAME&gt;</span>
</pre></div>


</li>
<li>
<p>Open your browser and navigate to your GitHub fork</p>
</li>
<li>
<p>Submit a pull request containing with the following body:</p>
<div class="codehilite"><pre><span></span><span class="c"><span style="color:red">&lt;LINK TO TWIKI DOCUMENT&gt;</span></span>

<span class="o">-</span> <span class="p">[</span> <span class="p">]</span> <span class="n">Enter</span> <span class="n">date</span> <span class="n">into</span> &quot;<span class="n">Migrated</span>&quot; <span class="n">column</span> <span class="n">of</span> <span class="n">google</span> <span class="n">sheet</span>
</pre></div>


<ul>
<li>
<p>If you are migrating a document, also add this task:</p>
<div class="codehilite"><pre><span></span>- [ ] Add migration header to TWiki document
</pre></div>


</li>
<li>
<p>If you are archiving a document, add this task:</p>
<div class="codehilite"><pre><span></span>- [ ] Move TWiki document to the trash
</pre></div>


</li>
</ul>
</li>
</ol>
<p>See an example pull request <a href="https://github.com/opensciencegrid/technology/pull/98">here</a>.</p>
<h2 id="after-the-pull-request">After the pull request<a class="headerlink" href="#after-the-pull-request" title="Permanent link">&para;</a></h2>
<p>After the pull request is merged, replace the contents of TWiki document with the div if you're migrating the document, linking to the location of the migrated document:</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;border: 1px solid black; margin: 1em 0; padding: 1em; background-color: #FFDDDD; font-weight: 600;&quot;</span><span class="nt">&gt;</span>
This document has been migrated to !GitHub (<span class="nt">&lt;LINK</span> <span class="err">TO</span> <span class="err">GITHUB</span> <span class="err">DOCUMENT</span><span class="nt">&gt;</span>). If you wish to see the old TWiki document, use the TWiki history below.

Background:

At the end of year (2017), the TWiki will be retired in favor of !GitHub. You can find the various TWiki webs and their new !GitHub locations listed below:

   * Release3: https://opensciencegrid.github.io/docs ([[https://github.com/opensciencegrid/docs/tree/master/archive][archive]])
   * !SoftwareTeam: https://opensciencegrid.github.io/technology ([[https://github.com/opensciencegrid/technology/tree/master/archive][archive]])
<span class="nt">&lt;/div&gt;</span>
</pre></div>


<p>If you are archiving a document, move it to the trash instead. Once the document has been updated or trashed, add the date to the spreadsheet and go back to your pull request and mark your tasks as complete. For example, if you completed the migration of a document:</p>
<div class="codehilite"><pre><span></span>- [X] Enter date into &quot;Migrated&quot; column of google sheet
- [X] Add migration div to TWiki document
</pre></div>


<p>Currently, we do not recommend changing backlinks (links on other twiki pages that refer to the Twiki page you are migrating) to point at the new GitHub URL.  This is to provide a simple reminder to users that the migration will occur, and also is likely low priority regardless as all pages will eventually migrate to GitHub.  This advice may change in the future as we gain experience with this transition.</p>
<h2 id="reviewing-pull-requests">Reviewing pull requests<a class="headerlink" href="#reviewing-pull-requests" title="Permanent link">&para;</a></h2>
<p>To review pull requests, <code>cd</code> into the dir containing your git repository and check out the requester's branch, which the twiki-converter container should automatically notice. Here's an example checking out Brian's <code>cut-sw-release</code> branch of the technology repository:</p>
<div class="codehilite"><pre><span></span><span class="gp">#</span> Add the requester<span class="s1">&#39;s repo as a remote if you haven&#39;</span>t already
<span class="gp">user@host $</span> git remote add blin https://www.github.com/brianhlin/technology.git
<span class="gp">user@host $</span> git fetch --all
<span class="gp">user@host $</span> git checkout blin/cut-sw-release
</pre></div>


<p>Refresh your browser and navigate to the document in the request.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../koji-workflow/" class="btn btn-neutral float-right" title="Koji Workflow">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../development-process/" class="btn btn-neutral" title="Development Process"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/opensciencegrid/technology" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../development-process/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../koji-workflow/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/require.js"></script>
      <script src="../../search/search.js"></script>

</body>
</html>
